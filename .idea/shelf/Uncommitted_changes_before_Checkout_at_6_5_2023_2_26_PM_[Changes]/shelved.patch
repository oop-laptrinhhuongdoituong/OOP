Index: src/main/java/com/example/baitaplonoop/controller/GUI32Controller.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.baitaplonoop.controller;\r\n\r\nimport com.example.baitaplonoop.sql.DBConnect;\r\nimport com.example.baitaplonoop.util.AlertOOP;\r\nimport com.example.baitaplonoop.util.ChangeScene;\r\nimport com.example.baitaplonoop.util.showTreeViewCategory;\r\nimport javafx.embed.swing.SwingFXUtils;\r\nimport javafx.fxml.FXML;\r\nimport javafx.fxml.Initializable;\r\nimport javafx.scene.control.*;\r\nimport javafx.scene.image.Image;\r\nimport javafx.scene.image.ImageView;\r\nimport javafx.scene.layout.AnchorPane;\r\n\r\nimport java.awt.image.BufferedImage;\r\nimport java.io.*;\r\nimport java.net.URI;\r\nimport java.net.URL;\r\nimport java.nio.file.Files;\r\nimport java.nio.file.Path;\r\nimport java.nio.file.Paths;\r\nimport java.nio.file.StandardCopyOption;\r\nimport java.sql.SQLException;\r\nimport java.util.Arrays;\r\nimport java.util.ResourceBundle;\r\n\r\nimport com.example.baitaplonoop.util.addValueComboBox;\r\nimport javafx.scene.media.Media;\r\nimport javafx.scene.media.MediaPlayer;\r\nimport javafx.scene.media.MediaView;\r\nimport javafx.stage.FileChooser;\r\nimport javafx.util.Duration;\r\n\r\nimport javax.imageio.ImageIO;\r\n\r\npublic class GUI32Controller implements Initializable {\r\n    public TreeView<String> showCategory_tv;\r\n    public TextArea questionText_tf;\r\n    public TextField questionName_tf;\r\n    public Label categoryName_lb;\r\n    public Button addQuestion_btn;\r\n    public TextField choice1_tf;\r\n    public ComboBox<String> gradeChoice1_cb;\r\n    public ComboBox<String> gradeChoice2_cb;\r\n    public TextField choice2_tf;\r\n    public TextField choice3_tf;\r\n    public ComboBox<String> gradeChoice3_cb;\r\n    public TextField choice4_tf;\r\n    public ComboBox<String> gradeChoice4_cb;\r\n    public TextField choice5_tf;\r\n    public ComboBox<String> gradeChoice5_cb;\r\n    public TextField choice6_tf;\r\n    public ComboBox<String> gradeChoice6_cb;\r\n    public Button createChoice_btn;\r\n    public AnchorPane paneChoice2_ap;\r\n    public AnchorPane buttonPane_ap;\r\n    public AnchorPane paneInScrollPane_ap;\r\n    public ImageView imageQuestion_iv;\r\n    public Button imageQuestion_btn;\r\n    public Slider timeSlider;\r\n    public Button playVideo;\r\n    public Button pause_btn;\r\n    public Button videoQuestion_btn;\r\n    public Label questionLabel_lb;\r\n    public ComboBox<String> selectMedia_cb;\r\n    public Button gifQuestion_btn;\r\n    public AnchorPane videoPane_ap;\r\n    public ImageView gifQuestion_iv;\r\n    public Button addImageChoice3_btn;\r\n    public ImageView imageChoice3_iv;\r\n    public Button addImageChoice1_btn;\r\n    public ImageView imageChoice1_iv;\r\n    public Button addImageChoice2_btn;\r\n    public ImageView imageChoice2_iv;\r\n    public Button addImageChoice4_btn;\r\n    public ImageView imageChoice4_iv;\r\n    public Button addImageChoice5_btn;\r\n    public ImageView imageChoice5_iv;\r\n    public Button addImageChoice6_btn;\r\n    public ImageView imageChoice6_iv;\r\n    public Button editing_btn;\r\n    public Button cancel_btn;\r\n    @FXML\r\n    private MediaView mediaQuestion_mv;\r\n    boolean checkAddCategoryQuestion;\r\n    String nameCategoryQuestion = \"null\";\r\n    Double gradeChoice1 = 0.0, gradeChoice2 = 0.0, gradeChoice3 = 0.0, gradeChoice4 = 0.0, gradeChoice5 = 0.0, gradeChoice6 = 0.0;\r\n    DBConnect db = new DBConnect();\r\n    private MediaPlayer mediaPlayer;\r\n    public Integer ChoiceNumberInQuestion() {\r\n        int choiceNumber = 0;\r\n        for (TextField textField : Arrays.asList(choice1_tf, choice2_tf, choice3_tf, choice4_tf, choice5_tf, choice6_tf)) {\r\n            if (!textField.getText().trim().equals(\"\")) {\r\n                choiceNumber++;\r\n            }\r\n        }\r\n        return choiceNumber;\r\n    } // Return Number of TextField Choice is Edited\r\n    // View in Editing Question From GUI21\r\n    public void editingQuestionChoice(String categoryName, String questionID, String questionText, String questionMedia, String choiceText1, String choiceGrade1, String choiceMedia1, String choiceText2, String choiceGrade2, String choiceMedia2, String choiceText3, String choiceGrade3, String choiceMedia3, String choiceText4, String choiceGrade4, String choiceMedia4, String choiceText5, String choiceGrade5, String choiceMedia5, String choiceText6, String choiceGrade6, String choiceMedia6) throws FileNotFoundException {\r\n        videoPane_ap.setVisible(false);\r\n        paneChoice2_ap.setVisible(false);\r\n        nameCategoryQuestion = categoryName;\r\n        questionLabel_lb.setText(\"Editing a Multilple choice question\");\r\n        categoryName_lb.setText(categoryName);\r\n        questionName_tf.setText(questionID);\r\n        questionName_tf.setEditable(false);\r\n        questionText_tf.setText(questionText);\r\n        choice1_tf.setText(choiceText1);\r\n        choice2_tf.setText(choiceText2);\r\n        choice3_tf.setText(choiceText3);\r\n        choice4_tf.setText(choiceText4);\r\n        choice5_tf.setText(choiceText5);\r\n        choice6_tf.setText(choiceText6);\r\n        loadFile(questionMedia, imageQuestion_iv, gifQuestion_iv, mediaQuestion_mv);\r\n        if (!choiceText1.trim().equals(\"\")) {\r\n            gradeChoice1_cb.setEditable(true);\r\n            gradeChoice1_cb.getEditor().setText(Float.parseFloat(choiceGrade1) * 100 + \"%\");\r\n            loadImage(choiceMedia1, imageChoice1_iv);\r\n        }\r\n        if (!choiceText2.trim().equals(\"\")) {\r\n            gradeChoice2_cb.setEditable(true);\r\n            gradeChoice2_cb.getEditor().setText(Float.parseFloat(choiceGrade2) * 100 + \"%\");\r\n            loadImage(choiceMedia2, imageChoice2_iv);\r\n        }\r\n        if (!choiceText3.trim().equals(\"\")) {\r\n            gradeChoice3_cb.setEditable(true);\r\n            gradeChoice3_cb.getEditor().setText(Float.parseFloat(choiceGrade3) * 100 + \"%\");\r\n            loadImage(choiceMedia3, imageChoice3_iv);\r\n        }\r\n        if (!choiceText4.trim().equals(\"\")) {\r\n            gradeChoice4_cb.setEditable(true);\r\n            gradeChoice4_cb.getEditor().setText(Float.parseFloat(choiceGrade4) * 100 + \"%\");\r\n            loadImage(choiceMedia4, imageChoice4_iv);\r\n        }\r\n        if (!choiceText5.trim().equals(\"\")) {\r\n            gradeChoice5_cb.setEditable(true);\r\n            gradeChoice5_cb.getEditor().setText(Float.parseFloat(choiceGrade5) * 100 + \"%\");\r\n            loadImage(choiceMedia5, imageChoice5_iv);\r\n        }\r\n        if (!choiceText6.trim().equals(\"\")) {\r\n            gradeChoice6_cb.setEditable(true);\r\n            gradeChoice6_cb.getEditor().setText(Float.parseFloat(choiceGrade6) * 100 + \"%\");\r\n            loadImage(choiceMedia6, imageChoice6_iv);\r\n        }\r\n        if (!choiceText4.trim().equals(\"\") || !choiceText5.trim().equals(\"\") || !choiceText6.trim().equals(\"\")) {\r\n            paneChoice2_ap.setTranslateY(239);\r\n            buttonPane_ap.setTranslateY(239);\r\n            paneChoice2_ap.setVisible(true);\r\n        }\r\n    }\r\n    @Override\r\n    public void initialize(URL url, ResourceBundle resourceBundle) {\r\n        videoPane_ap.setVisible(false);\r\n        paneChoice2_ap.setVisible(false);\r\n        addValueComboBox.addValue(gradeChoice1_cb);\r\n        addValueComboBox.addValue(gradeChoice2_cb);\r\n        addValueComboBox.addValue(gradeChoice3_cb);\r\n        addValueComboBox.addValue(gradeChoice4_cb);\r\n        addValueComboBox.addValue(gradeChoice5_cb);\r\n        addValueComboBox.addValue(gradeChoice6_cb);\r\n        gradeChoice1_cb.setOnAction(gradeChoice1Event -> gradeChoice1 = addValueComboBox.convertStringToDouble(gradeChoice1_cb));\r\n        gradeChoice2_cb.setOnAction(gradeChoice2Event -> gradeChoice2 = addValueComboBox.convertStringToDouble(gradeChoice2_cb));\r\n        gradeChoice3_cb.setOnAction(gradeChoice3Event -> gradeChoice3 = addValueComboBox.convertStringToDouble(gradeChoice3_cb));\r\n        gradeChoice4_cb.setOnAction(gradeChoice4Event -> gradeChoice4 = addValueComboBox.convertStringToDouble(gradeChoice4_cb));\r\n        gradeChoice5_cb.setOnAction(gradeChoice5Event -> gradeChoice5 = addValueComboBox.convertStringToDouble(gradeChoice5_cb));\r\n        gradeChoice6_cb.setOnAction(gradeChoice6Event -> gradeChoice6 = addValueComboBox.convertStringToDouble(gradeChoice6_cb));\r\n        selectMedia_cb.getItems().addAll(\"Add Video\", \"Add Image\", \"Add Gif\");\r\n        //Chọn hiện button thêm ảnh, video, gif vào question\r\n        selectMedia_cb.setOnAction(selectMediaEvent -> {\r\n            String selectedItem = selectMedia_cb.getSelectionModel().getSelectedItem();\r\n            switch (selectedItem) {\r\n                case \"Add Video\" -> {\r\n                    videoQuestion_btn.setVisible(true);\r\n                    imageQuestion_btn.setVisible(false);\r\n                    gifQuestion_btn.setVisible(false);\r\n                }\r\n                case \"Add Image\" -> {\r\n                    videoQuestion_btn.setVisible(false);\r\n                    imageQuestion_btn.setVisible(true);\r\n                    gifQuestion_btn.setVisible(false);\r\n                }\r\n                case \"Add Gif\" -> {\r\n                    videoQuestion_btn.setVisible(false);\r\n                    imageQuestion_btn.setVisible(false);\r\n                    gifQuestion_btn.setVisible(true);\r\n                }\r\n            }\r\n        });\r\n        // Event to show category in TreeView\r\n        categoryName_lb.setOnMouseClicked(mouseEvent -> {\r\n            if (questionName_tf.isEditable()) {\r\n                showCategory_tv.setVisible(true);\r\n                categoryName_lb.setVisible(false);\r\n                checkAddCategoryQuestion = true;\r\n                TreeItem<String> root = new TreeItem<>(\"Course IT:\");\r\n                showTreeViewCategory.setTreeViewImport(\"Select * from Category where parentID IS NULL\", root);\r\n                showCategory_tv.setRoot(root);\r\n                showCategory_tv.getSelectionModel().selectedItemProperty().addListener((observableValue, oldValue, newValue) -> {\r\n                    if (newValue != null) {\r\n                        categoryName_lb.setText(newValue.getValue());\r\n                        nameCategoryQuestion = newValue.getValue();\r\n                    }\r\n                    showCategory_tv.setVisible(false);\r\n                    categoryName_lb.setVisible(true);\r\n                });\r\n            }\r\n        });\r\n        // Event to creat new 3 choice\r\n        createChoice_btn.setOnMouseClicked(createChoiceEvent -> {// Event to creat new 3 choice\r\n            paneChoice2_ap.setTranslateY(239);\r\n            buttonPane_ap.setTranslateY(239);\r\n            paneChoice2_ap.setVisible(true);\r\n        });\r\n        // Add image in Question Text (upload in ImageView not to save in Database)\r\n        imageQuestion_btn.setOnAction(e -> AddImageToImageView(imageQuestion_iv));\r\n        addImageChoice1_btn.setOnAction(e -> AddImageToImageView(imageChoice1_iv));\r\n        addImageChoice2_btn.setOnAction(e -> AddImageToImageView(imageChoice2_iv));\r\n        addImageChoice3_btn.setOnAction(e -> AddImageToImageView(imageChoice3_iv));\r\n        addImageChoice4_btn.setOnAction(e -> AddImageToImageView(imageChoice4_iv));\r\n        addImageChoice5_btn.setOnAction(e -> AddImageToImageView(imageChoice5_iv));\r\n        addImageChoice6_btn.setOnAction(e -> AddImageToImageView(imageChoice6_iv));\r\n        // Add gif in Question Text (upload in ImageView not to save in Database)\r\n        gifQuestion_btn.setOnAction(e -> {\r\n            FileChooser fileChooser = new FileChooser();\r\n            fileChooser.getExtensionFilters().add(\r\n                    new FileChooser.ExtensionFilter(\"GIF files (*.gif)\", \"*.gif\")\r\n            );\r\n            File file = fileChooser.showOpenDialog(null);\r\n            if (file != null) {\r\n                String urlGif = file.toURI().toString();\r\n                Image image = new Image(urlGif);\r\n                imageQuestion_iv.setImage(image);\r\n            }\r\n        });\r\n        // Add video in Question Text (upload in MediaView not to save in Database)\r\n        videoQuestion_btn.setOnAction(e -> {\r\n            FileChooser fileChooser = new FileChooser();\r\n            fileChooser.getExtensionFilters().addAll(\r\n                    new FileChooser.ExtensionFilter(\"MP4 files (*.mp4)\", \"*.mp4\"),\r\n                    new FileChooser.ExtensionFilter(\"AVI files (*.avi)\", \"*.avi\")\r\n            );\r\n            File file = fileChooser.showOpenDialog(null);\r\n            if (file != null) {\r\n                String urlVideoQuestion = file.toURI().toString();\r\n                Media media = new Media(urlVideoQuestion);\r\n                mediaPlayer = new MediaPlayer(media);\r\n                mediaQuestion_mv.setMediaPlayer(mediaPlayer);\r\n                videoPane_ap.setVisible(true);\r\n                setVideoPlay(mediaPlayer);\r\n            }\r\n        });\r\n        playVideo.setOnAction(e -> {\r\n            if (mediaPlayer != null) {\r\n                mediaPlayer.play();\r\n            }\r\n        });\r\n        pause_btn.setOnAction(e -> {\r\n            if (mediaPlayer != null) {\r\n                mediaPlayer.pause();\r\n            }\r\n        });\r\n        addQuestion_btn.setOnMouseClicked(saveChangeEvent -> {\r\n            try {\r\n                AddQuestionIntoSQL();\r\n            } catch (SQLException e) {\r\n                throw new RuntimeException(e);\r\n            }\r\n            ChangeScene.changeSceneUsingMouseEvent(this, \"/com/example/baitaplonoop/GUI11.fxml\", saveChangeEvent);\r\n        });\r\n        cancel_btn.setOnMouseClicked(cancelEvent -> ChangeScene.changeSceneUsingMouseEvent(this, \"/com/example/baitaplonoop/GUI11.fxml\", cancelEvent));\r\n        editing_btn.setOnMouseClicked(saveChangeContinueEditEvent -> {\r\n            try {\r\n                AddQuestionIntoSQL();\r\n            } catch (SQLException e) {\r\n                throw new RuntimeException(e);\r\n            }\r\n        });\r\n    }\r\n    private void setVideoPlay(MediaPlayer mediaPlayer) {\r\n        mediaPlayer.currentTimeProperty().addListener((obs, oldTime, newTime) -> {\r\n            if (!timeSlider.isValueChanging()) {\r\n                timeSlider.setValue(newTime.toSeconds() / mediaPlayer.getTotalDuration().toSeconds() * 100);\r\n            }\r\n        });\r\n        timeSlider.valueProperty().addListener((obs, oldValue, newValue) -> {\r\n            if (timeSlider.isValueChanging()) {\r\n                mediaPlayer.seek(mediaPlayer.getTotalDuration().multiply(newValue.doubleValue() / 100));\r\n            }\r\n        });\r\n    }\r\n    public boolean CheckDuration(MediaView mediaView) {\r\n        MediaPlayer mediaPlayer = mediaView.getMediaPlayer();\r\n        Duration duration = mediaPlayer.getTotalDuration();\r\n        // Chuyển đổi Duration sang giây\r\n        double seconds = duration.toSeconds();\r\n        return 1 <= seconds & seconds <= 10;\r\n    } // Check Duration Video in Question between 1s and 10s\r\n    public String saveImage(ImageView imageView, String pathImage, String imageID) {\r\n        String questionMediaPath = null;\r\n        try {\r\n            File target = new File(pathImage + File.separator + imageID + \".png\");\r\n            BufferedImage toWrite = SwingFXUtils.fromFXImage(imageView.getImage(), null);\r\n            ImageIO.write(toWrite, \"png\", target);\r\n            questionMediaPath = pathImage + File.separator + imageID + \".png\";\r\n        } catch (Exception x) {\r\n            System.err.println(\"Failed to save image\");\r\n            x.printStackTrace();\r\n        }\r\n        return questionMediaPath;\r\n    } // Save Image in the local memory\r\n    public String questionMediaPath() {\r\n        if (imageQuestion_iv.getImage() != null)\r\n            return saveImage(imageQuestion_iv, \"./src/main/resources/com/example/baitaplonoop/Media/Image/Question\", questionName_tf.getText());\r\n        else if (gifQuestion_iv.getImage() != null)\r\n            return saveGif(gifQuestion_iv, \"./src/main/resources/com/example/baitaplonoop/Media/GIF/Question\", questionName_tf.getText().trim());\r\n        else if (mediaQuestion_mv.getMediaPlayer() != null)\r\n            return saveVideo(mediaQuestion_mv, \"./src/main/resources/com/example/baitaplonoop/Media/Video\", questionName_tf.getText().trim());\r\n        else return null;\r\n    }   // To return path to Media in Question, this prepare for save in the database\r\n    public String saveVideo(MediaView mediaView, String pathVideo, String questionID) {\r\n        String questionVideoPath = null;\r\n        if (CheckDuration(mediaView)) {\r\n            try {\r\n                MediaPlayer mediaPlayer = mediaView.getMediaPlayer();\r\n                Media media = mediaPlayer.getMedia();\r\n                String source = media.getSource();\r\n                File sourceFile = new File(new URI(source));\r\n                File targetFile = new File(pathVideo + File.separator + questionID + \".mp4\");\r\n                Files.copy(sourceFile.toPath(), targetFile.toPath(), StandardCopyOption.REPLACE_EXISTING);\r\n                questionVideoPath = pathVideo + File.separator + questionID + \".mp4\";\r\n            } catch (Exception e) {\r\n                System.err.println(\"Failed to save video\");\r\n                e.printStackTrace();\r\n            }\r\n        }\r\n        return questionVideoPath;\r\n    }\r\n\r\n    public String saveGif(ImageView imageView, String pathGIF, String questionID) {\r\n        String questionGifPah = null;\r\n        try {\r\n            File target = new File(pathGIF + File.separator + questionID + \"gif\");\r\n            BufferedImage toWrite = SwingFXUtils.fromFXImage(imageView.getImage(), null);\r\n            ImageIO.write(toWrite, \"gif\", target);\r\n            questionGifPah = target.getAbsolutePath();\r\n        } catch (Exception x) {\r\n            System.err.println(\"Failed to save gif\");\r\n            x.printStackTrace();\r\n        }\r\n        return questionGifPah;\r\n    }   // Save GIF in the local memory\r\n    public String getCategoryIDQuestion() {\r\n        if (nameCategoryQuestion != null) {\r\n            try {\r\n                return db.FindCategoryID(nameCategoryQuestion);\r\n            } catch (SQLException e) {\r\n                throw new RuntimeException(e);\r\n            }\r\n        } else return null;\r\n    } // Return categoryID in question\r\n    public void AddQuestionIntoSQL() throws SQLException {\r\n        if (questionName_tf.getText().trim().equals(\"\") || questionText_tf.getText().trim().equals(\"\") || ChoiceNumberInQuestion() < 2) {\r\n            AlertOOP.mustFill(\"Add Question Status\", \"Add Question Fail\", \"You must fill in Question Name, Question Text and minimum 2 Choice\");\r\n        } else {\r\n            boolean checkQuestionExist;\r\n            try {\r\n                checkQuestionExist = db.checkQuestionID(questionName_tf.getText().trim());\r\n            } catch (SQLException e) {\r\n                throw new RuntimeException(e);\r\n            }\r\n            if (checkQuestionExist & questionName_tf.isEditable())\r\n                AlertOOP.mustFill(\"Add Question Status\", \"Add Question Fail\", \"Question Name exists\");\r\n            else {\r\n                String pathMediaQuestion = questionMediaPath();\r\n                String[] questionInfo = {getCategoryIDQuestion(), questionName_tf.getText().trim(), questionText_tf.getText().trim(), \"1\", pathMediaQuestion};\r\n                try {\r\n                    int addQuestion = db.UpdateQuestion(questionInfo);\r\n                } catch (SQLException e) {\r\n                    throw new RuntimeException(e);\r\n                }\r\n                if (!choice1_tf.getText().trim().equals(\"\")) {\r\n                    if (imageChoice1_iv.getImage() != null) {\r\n                        String pathMediaChoice = saveImage(imageChoice1_iv, \"./src/main/resources/com/example/baitaplonoop/Media/Image/Choice\", questionName_tf.getText() + \"1\");\r\n                        String[] addChoice1 = {choice1_tf.getText(), String.valueOf(gradeChoice1), questionName_tf.getText() + \"1\", questionName_tf.getText(), pathMediaChoice};\r\n                        db.UpdateChoice(addChoice1);\r\n                    } else {\r\n                        String[] addChoice1 = {choice1_tf.getText(), String.valueOf(gradeChoice1), questionName_tf.getText() + \"1\", questionName_tf.getText(), null};\r\n                        db.UpdateChoice(addChoice1);\r\n                    }\r\n                }\r\n                if (!choice2_tf.getText().trim().equals(\"\")) {\r\n                    if (imageChoice2_iv.getImage() != null) {\r\n                        String pathMediaChoice = saveImage(imageChoice2_iv, \"./src/main/resources/com/example/baitaplonoop/Media/Image/Choice\", questionName_tf.getText() + \"2\");\r\n                        String[] addChoice2 = {choice2_tf.getText(), String.valueOf(gradeChoice2), questionName_tf.getText() + \"2\", questionName_tf.getText(), pathMediaChoice};\r\n                        db.UpdateChoice(addChoice2);\r\n                    } else {\r\n                        String[] addChoice2 = {choice2_tf.getText(), String.valueOf(gradeChoice2), questionName_tf.getText() + \"2\", questionName_tf.getText(), null};\r\n                        db.UpdateChoice(addChoice2);\r\n                    }\r\n                }\r\n                if (!choice3_tf.getText().trim().equals(\"\")) {\r\n                    if (imageChoice3_iv.getImage() != null) {\r\n                        String pathMediaChoice = saveImage(imageChoice3_iv, \"./src/main/resources/com/example/baitaplonoop/Media/Image/Choice\", questionName_tf.getText() + \"3\");\r\n                        String[] addChoice3 = {choice3_tf.getText(), String.valueOf(gradeChoice3), questionName_tf.getText() + \"3\", questionName_tf.getText(), null, pathMediaChoice};\r\n                        db.UpdateChoice(addChoice3);\r\n                    } else {\r\n                        String[] addChoice3 = {choice3_tf.getText(), String.valueOf(gradeChoice3), questionName_tf.getText() + \"3\", questionName_tf.getText(), null, null};\r\n                        db.UpdateChoice(addChoice3);\r\n                    }\r\n                }\r\n                if (!choice4_tf.getText().trim().equals(\"\")) {\r\n                    if (imageChoice4_iv.getImage() != null) {\r\n                        String pathMediaChoice = saveImage(imageChoice4_iv, \"./src/main/resources/com/example/baitaplonoop/Media/Image/Choice\", questionName_tf.getText() + \"4\");\r\n                        String[] addChoice4 = {choice4_tf.getText(), String.valueOf(gradeChoice4), questionName_tf.getText() + \"4\", questionName_tf.getText(), null, pathMediaChoice};\r\n                        db.UpdateChoice(addChoice4);\r\n                    } else {\r\n                        String[] addChoice4 = {choice4_tf.getText(), String.valueOf(gradeChoice4), questionName_tf.getText() + \"4\", questionName_tf.getText(), null, null};\r\n                        db.UpdateChoice(addChoice4);\r\n                    }\r\n                }\r\n                if (!choice5_tf.getText().trim().equals(\"\")) {\r\n                    if (imageChoice5_iv.getImage() != null) {\r\n                        String pathMediaChoice = saveImage(imageChoice5_iv, \"./src/main/resources/com/example/baitaplonoop/Media/Image/Choice\", questionName_tf.getText() + \"5\");\r\n                        System.out.println(pathMediaChoice);\r\n                        String[] addChoice5 = {choice5_tf.getText(), String.valueOf(gradeChoice5), questionName_tf.getText() + \"5\", questionName_tf.getText(), null, pathMediaChoice};\r\n                        db.UpdateChoice(addChoice5);\r\n                    } else {\r\n                        String[] addChoice5 = {choice5_tf.getText(), String.valueOf(gradeChoice5), questionName_tf.getText() + \"5\", questionName_tf.getText(), null, null};\r\n                        db.UpdateChoice(addChoice5);\r\n                    }\r\n                }\r\n                if (!choice6_tf.getText().trim().equals(\"\")) {\r\n                    if (imageChoice6_iv.getImage() != null) {\r\n                        String pathMediaChoice = saveImage(imageChoice6_iv, \"./src/main/resources/com/example/baitaplonoop/Media/Image/Choice\", questionName_tf.getText() + \"6\");\r\n                        String[] addChoice6 = {choice6_tf.getText(), String.valueOf(gradeChoice6), questionName_tf.getText() + \"6\", questionName_tf.getText(), null, pathMediaChoice};\r\n                        db.UpdateChoice(addChoice6);\r\n                    } else {\r\n                        String[] addChoice6 = {choice6_tf.getText(), String.valueOf(gradeChoice6), questionName_tf.getText() + \"6\", questionName_tf.getText(), null, null};\r\n                        db.UpdateChoice(addChoice6);\r\n                    }\r\n                }\r\n                AlertOOP.AddDone(\"Add Question Status\", \"Add Question Done\", \"Done\");\r\n                showCategory_tv.setEditable(false);\r\n                questionName_tf.setEditable(false);\r\n                categoryName_lb.setMouseTransparent(false);\r\n            }\r\n        }\r\n    }   // Add new Question into SQL\r\n    public void AddImageToImageView(ImageView imageView) {\r\n        FileChooser fileChooser = new FileChooser();\r\n        fileChooser.getExtensionFilters().addAll(\r\n                new FileChooser.ExtensionFilter(\"JPG files (*.jpg)\", \"*.jpg\"),\r\n                new FileChooser.ExtensionFilter(\"PNG files (*.png)\", \"*.png\")\r\n        );\r\n        File file = fileChooser.showOpenDialog(null);\r\n        if (file != null) {\r\n            String url1 = file.toURI().toString();\r\n            Image image = new Image(url1);\r\n            imageView.setImage(image);\r\n        }\r\n    }\r\n    public void loadImage(String path, ImageView imageView) {\r\n        if (path == null || path.isEmpty()) {\r\n            return;\r\n        }\r\n        try {\r\n            Image image = new Image(new FileInputStream(path));\r\n            imageView.setImage(image);\r\n        } catch (FileNotFoundException e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n    // Load MediaQuestion from database path in the file local\r\n    public void loadFile(String path, ImageView imageViewImage, ImageView imageViewGif, MediaView mediaViewVideo) {\r\n        if (path == null || path.isEmpty()) return;\r\n        int dotIndex = path.lastIndexOf(\".\");\r\n        if (dotIndex == -1) return;\r\n        String extension = path.substring(dotIndex);\r\n        if (extension.equalsIgnoreCase(\".png\")) {\r\n            Image image = new Image(\"file:\" + path);\r\n            imageViewImage.setImage(image);\r\n            imageViewImage.setVisible(true);\r\n            imageViewGif.setVisible(false);\r\n            mediaViewVideo.setVisible(false);\r\n        } else if (extension.equalsIgnoreCase(\".gif\")) {\r\n            Image gif = new Image(\"file:\" + path);\r\n            imageViewGif.setImage(gif);\r\n            imageViewGif.setVisible(true);\r\n            imageViewImage.setVisible(false);\r\n            mediaViewVideo.setVisible(false);\r\n        } else if (extension.equalsIgnoreCase(\".mp4\")) {\r\n            Path pathVideo = Paths.get(path);\r\n            pathVideo = pathVideo.toAbsolutePath();\r\n            Media media = new Media(pathVideo.toUri().toString());\r\n            MediaPlayer mediaPlayer = new MediaPlayer(media);\r\n            mediaViewVideo.setMediaPlayer(mediaPlayer);\r\n            videoPane_ap.setVisible(true);\r\n            imageViewImage.setVisible(false);\r\n            imageViewGif.setVisible(false);\r\n            setVideoPlay(mediaPlayer);\r\n            playVideo.setOnAction(e -> mediaPlayer.play());\r\n            pause_btn.setOnAction(e -> mediaPlayer.pause());\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/baitaplonoop/controller/GUI32Controller.java b/src/main/java/com/example/baitaplonoop/controller/GUI32Controller.java
--- a/src/main/java/com/example/baitaplonoop/controller/GUI32Controller.java	
+++ b/src/main/java/com/example/baitaplonoop/controller/GUI32Controller.java	
@@ -229,8 +229,8 @@
             File file = fileChooser.showOpenDialog(null);
             if (file != null) {
                 String urlGif = file.toURI().toString();
-                Image image = new Image(urlGif);
-                imageQuestion_iv.setImage(image);
+                Image image1 = new Image(urlGif);
+                gifQuestion_iv.setImage(image1);
             }
         });
         // Add video in Question Text (upload in MediaView not to save in Database)
@@ -340,7 +340,7 @@
     public String saveGif(ImageView imageView, String pathGIF, String questionID) {
         String questionGifPah = null;
         try {
-            File target = new File(pathGIF + File.separator + questionID + "gif");
+            File target = new File(pathGIF + File.separator + questionID + ".gif");
             BufferedImage toWrite = SwingFXUtils.fromFXImage(imageView.getImage(), null);
             ImageIO.write(toWrite, "gif", target);
             questionGifPah = target.getAbsolutePath();
Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"AutoImportSettings\">\r\n    <option name=\"autoReloadType\" value=\"SELECTIVE\" />\r\n  </component>\r\n  <component name=\"ChangeListManager\">\r\n    <list default=\"true\" id=\"e99e4343-1934-4a34-858d-155e3f4e1670\" name=\"Changes\" comment=\"\">\r\n      <change beforePath=\"$PROJECT_DIR$/.idea/workspace.xml\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/.idea/workspace.xml\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/src/main/java/com/example/baitaplonoop/controller/GUI73Controller.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/src/main/java/com/example/baitaplonoop/controller/GUI73Controller.java\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/src/main/java/com/example/baitaplonoop/util/AnchorPaneGUI7.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/src/main/java/com/example/baitaplonoop/util/AnchorPaneGUI7.java\" afterDir=\"false\" />\r\n    </list>\r\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\r\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\r\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\r\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\r\n  </component>\r\n  <component name=\"FileTemplateManagerImpl\">\r\n    <option name=\"RECENT_TEMPLATES\">\r\n      <list>\r\n        <option value=\"JavaFXApplication\" />\r\n        <option value=\"JavaFXApplication\" />\r\n        <option value=\"FxmlFile\" />\r\n        <option value=\"FxmlFile\" />\r\n        <option value=\"Class\" />\r\n      </list>\r\n    </option>\r\n  </component>\r\n  <component name=\"Git.Settings\">\r\n    <option name=\"RECENT_BRANCH_BY_REPOSITORY\">\r\n      <map>\r\n        <entry key=\"$PROJECT_DIR$\" value=\"Dat\" />\r\n      </map>\r\n    </option>\r\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\r\n    <option name=\"UPDATE_TYPE\" value=\"REBASE\" />\r\n  </component>\r\n  <component name=\"MarkdownSettingsMigration\">\r\n    <option name=\"stateVersion\" value=\"1\" />\r\n  </component>\r\n  <component name=\"MavenImportPreferences\">\r\n    <option name=\"generalSettings\">\r\n      <MavenGeneralSettings>\r\n        <option name=\"mavenHome\" value=\"Use Maven wrapper\" />\r\n        <option name=\"useMavenConfig\" value=\"true\" />\r\n      </MavenGeneralSettings>\r\n    </option>\r\n  </component>\r\n  <component name=\"ProjectId\" id=\"2OQ6MePDlkzrfbaRYgtTZKnGXV0\" />\r\n  <component name=\"ProjectLevelVcsManager\" settingsEditedManually=\"true\">\r\n    <ConfirmationsSetting value=\"1\" id=\"Add\" />\r\n  </component>\r\n  <component name=\"ProjectViewState\">\r\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\r\n    <option name=\"showLibraryContents\" value=\"true\" />\r\n  </component>\r\n  <component name=\"PropertiesComponent\">{\r\n  &quot;keyToString&quot;: {\r\n    &quot;git-widget-placeholder&quot;: &quot;Phuc&quot;,\r\n    &quot;settings.editor.selected.configurable&quot;: &quot;preferences.externalResources&quot;\r\n  }\r\n}</component>\r\n  <component name=\"RecentsManager\">\r\n    <key name=\"CopyFile.RECENT_KEYS\">\r\n      <recent name=\"F:\\Project\\Java\\OOP\\src\\main\\resources\\com\\example\\baitaplonoop\\Image\\Question\" />\r\n      <recent name=\"C:\\Users\\HOANGPHUC\\IdeaProjects\\OOP\\src\\main\\java\\com\\example\\baitaplonoop\\model\" />\r\n      <recent name=\"C:\\Users\\HOANGPHUC\\IdeaProjects\\OOP\\src\\main\\resources\\com\\example\\baitaplonoop\\icon\" />\r\n    </key>\r\n    <key name=\"MoveFile.RECENT_KEYS\">\r\n      <recent name=\"C:\\Users\\ASUS\\Desktop\\Github\\OOP\\src\\main\\resources\\com\\example\\baitaplonoop\\icon\" />\r\n    </key>\r\n  </component>\r\n  <component name=\"RunManager\" selected=\"Application.Main\">\r\n    <configuration name=\"Main\" type=\"Application\" factoryName=\"Application\">\r\n      <option name=\"MAIN_CLASS_NAME\" value=\"com.example.baitaplonoop.Main\" />\r\n      <module name=\"BaiTapLonOOP\" />\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n      </method>\r\n    </configuration>\r\n    <configuration name=\"Test\" type=\"Application\" factoryName=\"Application\" temporary=\"true\" nameIsGenerated=\"true\">\r\n      <option name=\"MAIN_CLASS_NAME\" value=\"com.example.baitaplonoop.util.Test\" />\r\n      <module name=\"BaiTapLonOOP\" />\r\n      <extension name=\"coverage\">\r\n        <pattern>\r\n          <option name=\"PATTERN\" value=\"com.example.baitaplonoop.util.*\" />\r\n          <option name=\"ENABLED\" value=\"true\" />\r\n        </pattern>\r\n      </extension>\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n      </method>\r\n    </configuration>\r\n    <configuration name=\"main (1)\" type=\"Application\" factoryName=\"Application\" temporary=\"true\" nameIsGenerated=\"true\">\r\n      <option name=\"MAIN_CLASS_NAME\" value=\"com.example.baitaplonoop.main\" />\r\n      <module name=\"BaiTapLonOOP\" />\r\n      <extension name=\"coverage\">\r\n        <pattern>\r\n          <option name=\"PATTERN\" value=\"com.example.baitaplonoop.*\" />\r\n          <option name=\"ENABLED\" value=\"true\" />\r\n        </pattern>\r\n      </extension>\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n      </method>\r\n    </configuration>\r\n    <configuration name=\"main (2)\" type=\"Application\" factoryName=\"Application\" temporary=\"true\" nameIsGenerated=\"true\">\r\n      <option name=\"MAIN_CLASS_NAME\" value=\"com.example.baitaplonoop.main\" />\r\n      <module name=\"BaiTapLonOOP\" />\r\n      <extension name=\"coverage\">\r\n        <pattern>\r\n          <option name=\"PATTERN\" value=\"com.example.baitaplonoop.*\" />\r\n          <option name=\"ENABLED\" value=\"true\" />\r\n        </pattern>\r\n      </extension>\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n      </method>\r\n    </configuration>\r\n    <configuration name=\"main\" type=\"Application\" factoryName=\"Application\" temporary=\"true\" nameIsGenerated=\"true\">\r\n      <option name=\"MAIN_CLASS_NAME\" value=\"com.example.baitaplonoop.main\" />\r\n      <module name=\"BaiTapLonOOP\" />\r\n      <extension name=\"coverage\">\r\n        <pattern>\r\n          <option name=\"PATTERN\" value=\"com.example.baitaplonoop.*\" />\r\n          <option name=\"ENABLED\" value=\"true\" />\r\n        </pattern>\r\n      </extension>\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n      </method>\r\n    </configuration>\r\n    <configuration name=\"test\" type=\"Application\" factoryName=\"Application\" temporary=\"true\" nameIsGenerated=\"true\">\r\n      <option name=\"MAIN_CLASS_NAME\" value=\"com.example.baitaplonoop.test\" />\r\n      <module name=\"BaiTapLonOOP\" />\r\n      <extension name=\"coverage\">\r\n        <pattern>\r\n          <option name=\"PATTERN\" value=\"com.example.baitaplonoop.*\" />\r\n          <option name=\"ENABLED\" value=\"true\" />\r\n        </pattern>\r\n      </extension>\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n      </method>\r\n    </configuration>\r\n    <list>\r\n      <item itemvalue=\"Application.Main\" />\r\n      <item itemvalue=\"Application.Test\" />\r\n      <item itemvalue=\"Application.main (1)\" />\r\n      <item itemvalue=\"Application.main (2)\" />\r\n      <item itemvalue=\"Application.main\" />\r\n      <item itemvalue=\"Application.test\" />\r\n    </list>\r\n    <recent_temporary>\r\n      <list>\r\n        <item itemvalue=\"Application.Test\" />\r\n        <item itemvalue=\"Application.test\" />\r\n        <item itemvalue=\"Application.Main\" />\r\n        <item itemvalue=\"Application.main (2)\" />\r\n        <item itemvalue=\"Application.main (1)\" />\r\n      </list>\r\n    </recent_temporary>\r\n  </component>\r\n  <component name=\"SpellCheckerSettings\" RuntimeDictionaries=\"0\" Folders=\"0\" CustomDictionaries=\"0\" DefaultDictionary=\"application-level\" UseSingleDictionary=\"true\" transferred=\"true\" />\r\n  <component name=\"TaskManager\">\r\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\r\n      <changelist id=\"e99e4343-1934-4a34-858d-155e3f4e1670\" name=\"Changes\" comment=\"\" />\r\n      <created>1681480416050</created>\r\n      <option name=\"number\" value=\"Default\" />\r\n      <option name=\"presentableId\" value=\"Default\" />\r\n      <updated>1681480416050</updated>\r\n      <workItem from=\"1683383446033\" duration=\"277000\" />\r\n      <workItem from=\"1683398586586\" duration=\"1980000\" />\r\n      <workItem from=\"1683454805001\" duration=\"5451000\" />\r\n      <workItem from=\"1683468170394\" duration=\"10954000\" />\r\n      <workItem from=\"1683510360130\" duration=\"1484000\" />\r\n      <workItem from=\"1683511926552\" duration=\"1130000\" />\r\n      <workItem from=\"1683516948886\" duration=\"919000\" />\r\n      <workItem from=\"1683518011370\" duration=\"250000\" />\r\n      <workItem from=\"1683518291549\" duration=\"427000\" />\r\n      <workItem from=\"1683521666835\" duration=\"2913000\" />\r\n      <workItem from=\"1683538982523\" duration=\"6486000\" />\r\n      <workItem from=\"1683572165479\" duration=\"10000\" />\r\n      <workItem from=\"1683572410142\" duration=\"970000\" />\r\n      <workItem from=\"1683573395622\" duration=\"3473000\" />\r\n      <workItem from=\"1683577609966\" duration=\"2766000\" />\r\n      <workItem from=\"1683581477159\" duration=\"247000\" />\r\n      <workItem from=\"1683589851139\" duration=\"596000\" />\r\n    </task>\r\n    <servers />\r\n  </component>\r\n  <component name=\"TypeScriptGeneratedFilesManager\">\r\n    <option name=\"version\" value=\"3\" />\r\n  </component>\r\n  <component name=\"Vcs.Log.Tabs.Properties\">\r\n    <option name=\"TAB_STATES\">\r\n      <map>\r\n        <entry key=\"MAIN\">\r\n          <value>\r\n            <State />\r\n          </value>\r\n        </entry>\r\n      </map>\r\n    </option>\r\n  </component>\r\n  <component name=\"XSLT-Support.FileAssociations.UIState\">\r\n    <expand />\r\n    <select />\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/workspace.xml b/.idea/workspace.xml
--- a/.idea/workspace.xml	
+++ b/.idea/workspace.xml	
@@ -6,8 +6,7 @@
   <component name="ChangeListManager">
     <list default="true" id="e99e4343-1934-4a34-858d-155e3f4e1670" name="Changes" comment="">
       <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/src/main/java/com/example/baitaplonoop/controller/GUI73Controller.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/com/example/baitaplonoop/controller/GUI73Controller.java" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/src/main/java/com/example/baitaplonoop/util/AnchorPaneGUI7.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/com/example/baitaplonoop/util/AnchorPaneGUI7.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/java/com/example/baitaplonoop/controller/GUI32Controller.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/com/example/baitaplonoop/controller/GUI32Controller.java" afterDir="false" />
     </list>
     <option name="SHOW_DIALOG" value="false" />
     <option name="HIGHLIGHT_CONFLICTS" value="true" />
